# Services 

Tenemos 4 tipos de servicios

- **NodePort:** Expone el Servicio en la IP de cada Nodo en un puerto estático.
- **Cluster IP:** Expone el Servicio en una IP interna del clúster. Al elegir este valor, solo se puede acceder al Servicio desde dentro del clúster.
- **Load Balancer:** Expone el Servicio externamente mediante un equilibrador de carga externo. Kubernetes no ofrece directamente un componente de equilibrio de carga; debe proporcionar uno o puede integrar su clúster de Kubernetes con un proveedor de nube.
- **ExternalName:** Asigna el servicio al contenido del campo externalName (por ejemplo, al nombre de host api.foo.bar.example). La asignación configura el servidor DNS de su clúster para devolver un registro CNAME con ese valor de nombre de host externo. No se configura ningún proxy de ningún tipo.

## Node Port

## ClusterIP

- Para probar el funcionamiento del servicio tipo ClusterIp vamos a desplegar el siguiente deployment

Creamos el archivo "deployment-definition.yaml" con el siguiente contenido

```
apiVersion: apps/v1
kind: Deployment
metadata:
  name: my-deployment
  labels:
      app: my-deployment
spec:
  replicas: 2
  selector:
    matchLabels:
      app: my-pod
  template: 
    metadata:
      labels: 
        app: my-pod   
    spec:
      containers:
        - name: nginx-container
          image: nginx
          ports:
            - containerPort: 80
```
```
kubectl create -f deployment-definition.yaml
```

Creamos el archivo "cluster-ip.yaml" con el siguiente contenido

```
apiVersion: v1
kind: Service
metadata:
  name: nginx-clusterip
spec:
  type: ClusterIP
  ports:
    - targetPort: 80
      port: 80
  selector:
      app: my-pod
```
```
kubectl apply -f cluster-ip.yaml
```

## Load Balancer #

- Para probar el funcionamiento del servicio tipo Load Balancer vamos a desplegar el siguiente deployment

Creamos el archivo "deployment-definition.yaml" con el siguiente contenido
```
apiVersion: apps/v1
kind: Deployment
metadata:
  name: my-deployment
  labels:
      app: my-deployment
spec:
  replicas: 2
  selector:
    matchLabels:
      app: my-pod
  template: 
    metadata:
      labels: 
        app: my-pod   
    spec:
      containers:
        - name: nginx-container
          image: nginx
          ports:
            - containerPort: 80
```
```
kubectl create -f deployment-definition.yaml
```

Creamos el archivo "load-balancer.yaml" con el siguiente contenido:
```
apiVersion: v1
kind: Service
metadata:
  name: nginx-service-loadbalancer
spec:
  type: LoadBalancer
  selector:
    app: my-pod
  ports:
    - protocol: TCP
      port: 80
      targetPort: 80
```
```
kubectl apply -f load-balancer.yaml
```
