# Introducción

Vamos a crear un cluster de kubernetes con sus respectivos nodegroups. Esta administración se hará de manera muy sencilla con la herramienta eksctl.

## Creando y manejando clusters

Para crear un cluster de manera rápida con la configuración por defecto lanzaremos el siguiente comando:

```
eksctl create cluster
```

Con este simple comando, eksctl creará un cluster en la región por defecto del AWS cli con un Managed Node Group conteniendo dos nodos m5.large.

## En accion: Creacion de un cluster básico

1.- Vamos al servio de AWS CloudShell

2.- Creamos un archivo y lo editamos con nano

```
nano basic.yaml
```

Colocamos el siguiente contenido en el archivo

```
apiVersion: eksctl.io/v1alpha5
kind: ClusterConfig

metadata:
  name: basic-cluster
  region: us-west-2

nodeGroups:
  - name: ng-1
    instanceType: t3.medium
    desiredCapacity: 2
    volumeSize: 80
```

En el archivo vamos a especificar los atributos del cluster. El cluster contiene un nodegroup con el nombre ng-1 y dos instancias del tamaño t3.medium con un disco de 80 GB.

3.- Creamos el cluster con eksctl. Asi que lanzamos el siguiente comando:

```
eksctl create cluster -f basic.yaml
```

La creación del cluster se hará mediante un stack de Cloudformation. Debemos esperar unos minutos a que se provicione el cluster.

![Verificar versiones](/img/2-1.image.jpg)

4.- Revisaremos algunos comandos importantes

- Listar los clusters

```
eksctl get clusters
```

- Listar nodegroups de un cluster

```
eksctl get nodegroups --cluster basic-cluster
```

- Para ver los nodos utilizamos kubectl

```
kubectl get nodes
```

5.- Para eliminar el cluster creado lanzamos el siguiente comando

```
eksctl delete cluster -f basic.yaml --disable-nodegroup-eviction
```
![Verificar versiones](/img/2-2.image.jpg)
